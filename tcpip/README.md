# TCP/IP

## ネットワークの歴史

- 1960年代は1台の大型コンピューターの処理を細かい時間に分割して、みんなで使用する「TSS」という方式でコンピューターを使用していた。遠隔地にいるユーザーはTSS端末から大型コンピューターに対して電話をかけてアクセスし、それが自分専用のコンピューターであるかのように扱うことができた。TSSにより、大型コンピューターとTSS端末の2台だけで構成されるシンプルなネットワークができた
- 1970年代になると、大型コンピューターだけでなく、マイコンのような小型コンピューターも登場し、たくさんのコンピューターを並列につないでいくようになった。その中でも重要な「ARPANET」がある。ARPANETはデータを「パケット」と呼ばれる小さな単位に分割してやりとりする「パケット交換方式」という伝送方式を世界で初めて採用した
- データの伝送方式には「回線交換方式」と「パケット交換方式」の2種類がある
- 回線交換方式
    - データをやり取りする前に1対1の伝送路(データの通り道)を作り、やり取りが終わるまで使い続ける方式。接続している間、回線を占領し繋ぎっぱなしのため効率が良くなかった
- パケット交換方式
    - 回線交換方式で課題となった回線利用率向上を目的として作られた
    - データを「パケット」と呼ばれる小さな単位で分割して、ネットワークに流す方式。送信側のコンピューターはデータに「ヘッダー」という情報をくっつけて、パケット交換機(ネットワーク機器)で構成されたパケット交換ネットワークにパケットを流す。ヘッダーには宛先となるコンピューター情報だったり、データの何番目に当たるパケットなのかだったり、色々な情報が含まれる
    - パケット交換ネットワークは、ヘッダーの情報を見て、宛先のコンピューターにパケットを送り届ける。また宛先コンピューターはヘッダーの情報を見て元のデータに復元する。
    - パケット交換方式は必要な時に必要な分だけ回線を利用できるだけでなく、その回線を利用して別のユーザーのデータも流すことができるため効率よく回線を使用できる
    - 経路上のどこかでパケットがなくなったり、パケットが壊れたりしても、すべてのデータを再送する必要はなく、その小さなパケットだけを再送すればよいのですぐに復旧できる
    - ネットワークをはじめとする現在のコンピューターネットワークはパケット交換方式でデータをやりとりしている。私たちのPCが元のデータに戻して、初めてyoutubeなど見ることができる

## 通信する時のルールがプロトコル

- パケットを処理する時のルールがプロトコル
- プロトコルが通信に必要な機能ごとしっかり整備されているおかげでPCのメーカーやOS、無線優先など気にすることなく、同じパケットでやり取りできる
- 「https」がまさにプロトコルにあたる
    - webブラウザ間の間で暗号化しながらパケットをやり取りする時に使用するプロトコル
    - httpsをつけることによって、httpsで決められた約束事に基づいてパケットを処理しますよと宣言している
- プロトコルで決まっていること
    - 物理的な使用
        - 有線の場合、テーブルの素材やコネクタの形状、そのピン配列に至るまで、ネットワークにおいて、目に見えるものはすべてプロトコルで定義される。
        - 無線の場合、Wi-Fi環境における電波の周波数やパケットをどのように電波に変換するかもプロトコルで定義されている
        - PCのNIC(Network Interface Cardはプロトコルで定義されている内容に基づいて、ケーブルや電波などの伝送媒体にパケットを流す
    - 送信相手の特定
        - ネットワークの世界でも、現実の世界と同じように住所を割り当てて、送信相手を区別している
            - ドメイン
            - IPアドレス
    - パケットの転送
        - データをパケットに分割して流している。
        - プロトコルでは、ヘッダーのどこからどこまで(何ビット目から何ビット目までに)どんな情報を含み、どんな順序でやりとりするかが定義されている
        - パケット交換ネットワークを構成しているパケット交換機はヘッダーの情報に基づいてバケツリレー的にパケットを転送している
    - 信頼性の確立
        - プロトコルはエラーを通知したり、データを再送したりしている
        - 有限なネットワークリソースがパケットでいっぱいにならないための仕組みも提供している
        - MVNOのスマホを使用している時、Webサイトが見づらくなる理由は、限られたネットワーク帯域をみんなで共有しており、ネットワーク制限されているため
        - MVNO
            - 携帯電話会社(NTTなど)から基地局などの通信設備を借りて、携帯電話サービスを提供している事業者、格安スマホや格安SIMなどの会社のこと
    - セキュリティの確保
        - プロトコルは重要な情報を安心してやり取りできるように正しい通信相手であるか認証し、通信を暗号化する仕組みを提供している。
        - 例えば、ユーザー名とパスワードでログインする時、Webブラウザは接続先のサーバーが正しい通信相手であることを確認した上で、ユーザー名とパスワードを暗号化して送信する
            - 正しい相手と通信しているか確認
            - 盗聴されてもわからないように暗号化
- プロトコルは階層で整理する
    - データの送信元のコンピューターは階層ごとに用意されたプロトコルに沿って、上の階層から順にデータを処理していき、パケットとして伝送媒体に流す
    - パケットを受け取ったコンピューターは逆に、下の階層から順に階層ごとに送信元コンピューターと同じプロトコルに沿ってデータを処理し元のデータに戻す。
- 二つの階層構造モデル
    - TCP/IP参照モデル
        - 以下、下から順に4層で構成されている。それぞれ順々に処理を行う。
        - リンク層
            - 第1層。デジタルデータを物理的な伝送媒体に流す変換や変調処理を行い且つその信頼性を確保する処理を行う(同じネットワークにいる端末と接続性を確保)
            - IEEE8023など
        - インターネット層
            - 第2層。宛先となるコンピューターまでの通信経路を確保する処理を行う(異なるネットワークにいる端末と接続性を確保)
            - IP,ICMP
        - トランスポート層
            - 第3層。アプリケーションの識別を行い、それに応じた通信制御を行う
            - TCP,UDP
        - アプリケーション層
            - 第4層。ユーザーに対してアプリケーションを提供する
            - HTTP,DNS,FTP,FTP,SSL/TLS,Syslog,SNMP,NTP
    - OSI参照モデル
        - 以下、下から順に7層で構成されている。それぞれ順々に処理を行う。
            - 物理層
                - デジタルデータを物理的な伝送媒体に流す変換、変調処理を行う
            - データリンク層
                - 物理層の信頼性を確保する処理を行う
            - ネットワーク層
                - 宛先となるコンピューターまでの通信経路を確保する
            - トランスポート層
                - アプリケーションの識別を行い、それに応じた通信制御を行う
            - セッション層
                - ログインやログアウトなどアプリケーションレベルの通信を管理する
            - プレゼンテーション層
                - アプリケーション層にわかるようにデータを変換する
            - アプリケーション層
                - アプリケーションの機能を提供する
- PDU
    - 各階層で処理されるひとまとまりのデータ、データの単位のことをPDUという
    - PDUは制御情報を含む「ヘッダー」と、データそのものである「ペイロード」で構成されており、処理される階層によって、名称が異なる
        - 物理層
            - ビット
        - データリンク層
            - フレーム
        - ネットワーク層
            - パケット
        - トランスポート層
            - セグメント(TCPの場合)、データグラム(UDPの場合)
        - アプリケーション層
            - メッセージ
- IEEE
    - 比較的ハードウェアの処理に近いプロトコル
    - 具体的なIEEE
        - イーサネット
        - 無線LAN
        - 無線PAN
        - 無線MAN
- IETF
    - 比較的ソフトウェア寄りのプロトコル
        - IPv4
        - TCP
        - DNS
        - IPv6
        - HTTP1.1
        - HTTP2 など
- 各階層が連携して動作する仕組み
    - カプセル化と非カプセル化
        - 送信端末はアプリケーション層から順にそれぞれの階層でペイロードにヘッダーをくっつけてPDUにしてから一つ下の階層に渡す。ヘッダーを付加する処理のことをカプセル化という
        - 一つ下の階層は、そのPDUをペイロードとして認識し、その階層のヘッダーを新しく付与する
        - 受信側は物理層から順に、それぞれの階層でPDUからヘッダーを取り外してペイロードのみを一つ上の階層に渡す。ヘッダーを取り外す処理のことを非カプセル化という
        - 一つ上の階層はそのペイロードをPDUとして認識し、その階層のヘッダーを取り外す
            <img width="651" alt="tcp1" src="https://github.com/RyotaroSeto/microservices-memo/assets/70475997/f1c87605-3c41-4962-a6e6-3e87668e266a">
            
    - コネクション型とコネクションレス型
        - コネクション型
            - コネクションとは通信端末同士に確立される倫理的な通信路のこと
            - コネクション型は、データを送信する前に通信相手に「データを送ってもいいですか」とお伺いして、コネクションを確立し、データをやり取りした後終了する
            - コネクション型はしっかりとした手順を踏むため、転送に若干時間がかかるが確実にデータを転送することができる
            - 代表的なコネクション型のプロトコルがTCP
        - コネクションレス型
            - いきなりデータを送ってコネクションを確立し、勝手に終了する
            - 送信したデータが必ずしも相手に届くとは限らないため、確実に転送できるとは言えないが、手順を省略している分、転送にかかる時間を短縮できる
            - 代表的なコネクションレス型のプロトコルがイーサネット
    - 定番プロトコル
        - 下から順に
            - 物理層とデータリンク層
                - 有線環境はイーサネット
                - 無線環境はIEEE802.11
            - ネットワーク層
                - IP
            - トランスポート層
                - TCPかUDP
                - 通信に信頼性を求めたい時はTCP,リアルタイム性を求めたい時はUDP
            - アプリケーション層
                - HTTP,HTTPS,QUIC,DNS
        - 実際に通信するときは、NICのデバイスドライバやOS、アプリケーションが各階層から使用するプロトコルを選んで、送信端末はカプセル化、受信端末は非カプセル化して通信を行う。
- ネットワークを構成する機器
    - ある階層で動作する機器はそれ以下の階層の基本的なプロトコルは処理できるが、それ階層より上の階層のプロトコルは処理できない。
    - 物理層で動作する機器
        - 物理層で動作する機器はパケットを光/電気信号に変換したり、電波に変調したりする機能を持っている
        - 光ファイバーに流す時は光信号に変換、LANケーブルに流す時は電気信号に変換
        - NIC
            - PCやサーバーなどのコンピューターをネットワークに接続するために必要なハードウェアのこと
            - 人によってネットワークインターフェイスやネットワークアダプタと言ったりするが機能はすべて同じ
            - PCやサーバー、スマホやタブレットなど、全てのネットワーク端末はアプリケーションとOSが処理したパケットをNICを使用してLANケーブルや電波に流す
        - リピーター
            - LANケーブルを流れる電気信号は伝送距離が長くなれば衰退し波形が壊れる
            - リピーターはそれをもう一度増幅し波形を整えてもう片方に転送する。それによって伝送距離を伸ばし、より遠くへパケットを届けられるようにできる
            - 最近は光ファイバーの普及もあり、あまり使われなくなっている
        - リピーターハブ
            - 受け取ったパケット(ビット)のコピーをそのまま他のすべてのポートに転送する機器
            - L2スイッチに置き換えられ、見る機会が少なくなった
        - メディアコンバーター
            - 電気信号と光信号を相互に変換する機器
            - 光ファイバーケーブルを接続できない機器しかない状況でネットワークを延ばしたい場合に使用する
            - 電気信号は衰退が激しく、LANケーブルは頑張っても100mまでしか延ばせない。そうなると光ファイバーケーブルを使用するしかなくなるが、光ファイバーケーブルに対応する機器は高価で手がでない。そんな時、接続する機器と機器の間にメディアコンバーターを挟み込み、途中を光信号で遠くまで飛ばして、ネットワークを延ばす
        - アクセスポイント
            - パケットを電波に変調・復調する機器。無線と有線の架け橋のようなもの
            - Wifiあるところに必ずアクセスポイントがある、Wifiに接続している時は、アクセスポイントを一旦経由して、有線のネットワークに入る。身近なアクセスポイントは家庭用Wifiルーター。
    - データリンク層で動作する機器
        - データリンク層で動作する機器はフレームのヘッダーに含まれる「MACアドレス」の情報のもとにフレーム転送する、MACアドレスはデータリンク層における住所
        - ブリッジ
            - ポートとポートの橋のような役割。端末から受け取ったMACアドレスをMACアドレステーブルで管理し、転送処理を行う。この転送処理のことをブリッジングという。ブリッジはL2スイッチに置き換えられ、単体機器として見ることはない
        - L2スイッチ
            - たくさんポートを持っているブリッジ。スイッチングハブと言ったりもする
            - ブリッジと同じで、端末から受け取ったフレームのMACアドレスをMACアドレステーブルで管理し転送処理を行う。この転生処理のことをL2スイッチングという。
            - L2スイッチはブリッジよりもたくさんの端末を接続できるため汎用性が高く、世の中に存在する有線端末のほぼすべてがL2スイッチを介してネットワークにつながっている
            - 家電量販店やオフィスのフロアでたくさんのポートがついている機器がL2スイッチ
    - ネットワーク層で動作する機器
        - ネットワーク層で動作する機器はIPパケットのヘッダーに含まれるIPアドレスの情報を元にパケット転送する
        - ルーター
            - 端末から受け取ったIPパケットのIPアドレスをみて、自分のネットワークを超えたところにいる端末へと届ける役割。
            - IPアドレスをバケツリレーして目的地へと届ける。このバケツリレーのことをルーティングという。身近でいうとWifiルーターなど
            - ルーターはルーティングテーブルという表を元にパケットの受け渡し先を管理している
        - L3スイッチ
            - L2スイッチを足し合わせたような機器。ポートをたくさん持っているためたくさんの端末を接続でき、IPパケットをルーティングすることもできる。
            - L3スイッチはMACアドレステーブルとルーティングテーブルを組み合わせた情報をFPGAやASICなどのパケット転送処理専用ハードウェアに書き込み、その情報を元にスイッチングしたり、ルーティングしたりする。
    - トランスポート層で動作する機器
        - アプリケーションを識別し、その要件に応じた通信制御を行う階層
        - トランスポート層で動作する機器は、セグメントまたはデータグラムのヘッダーに含まれるポート番号をもとにパケット転送を行う。
        - ファイアウォール
            - ファイアウォールは端末間でやり取りされるパケットのIPアドレスやポート番号を見て通信を許可したり、ブロックしたりする。この通信制御機能のことをステートフルインスペクションという。
    - アプリケーション層で動作する機器
        - 次世代ファイアウォール
            - ファイアウォールの進化版。ステートフルインスペクションに加え、VPNやIDS/IPSなど様々なセキュリティ機能を詰め込み、結合化を図っている。
            - IPアドレスやポート番号だけでなく、色々な情報をアプリケーションレベルで解析することで、トランディショナルファイアウォールより高次元のセキュリティ、高次元の運用管理性を実現している
        - WAF
            - Webアプリケーションサーバーの安全を守るために使用する機器。XSSやSQLインジェクションなどがここ最近増えている。
            - クライアントとサーバーの間でやり取りされる情報の振る舞いをアプリケーションレベルで一つ一つ検査し、必要に応じてブロックする
        - 負荷分散スイッチ(L7スイッチ)
            - サーバーの負荷を分散する機器。ロードバランサーと呼んだりL7スイッチと呼んだりする
            - 1台のサーバーで処理できるトラフィックの量は限られているが、負荷分散装置はクライアントから受け取ったパケットを負荷分散方式という決まりごとに基づき、背後にいる複数のサーバーに振り分けることによって、システム全体で処理できるトラフィック量の拡張を図る。
- 色々なネットワーク機器の形
    - データリンク層以上で動作するネットワーク機器はさらに「物理アプライアンス」と「仮想アプライアンス」の2種類に大別できる。
    - 物理アプライアンス
        - 目で見ることができる。箱型の装置。サーバーラックに搭載されていたり、家電量販店に並んでいるネットワーク機器をイメージするとわかりやすい。
        - 簡単な処理や逆に複雑な処理を別の専用ハードウェアに任せることで、処理の効率化を図り、パフォーマンス向上を図っている
    - 仮想アプライアンス
        - 仮想化技術を提供するソフトウェアの上で動作するネットワーク機器
        - 仮想化ソフトウェアを利用して、ハードウェアを仮想的に分割し、OSに割り当てることで、物理サーバーの分割を実現する
        - 仮想化技術によってできる機器を仮想マシンという。
        - 仮想化技術は物理的に何台もある機器を1台のサーバーに集約して、設置スペースの節約を図れたり、余りあるリソースを有効活用できたりと、システム管理者にとって、コスト以上のメリットをもたらす。
        - 最近ではネットワーク機器を仮想化しようとEFVの流れもあって、スペックと要件さえ見合えば仮想アプライアンスが選択されることが多い
- ネットワークの形

<img width="623" alt="tcp2" src="https://github.com/RyotaroSeto/microservices-memo/assets/70475997/f9a68002-ad6f-48fc-bfa3-4dbdaa0c35fc">

- LAN
    - local area networkの略。家庭や企業など限られた範囲のネットワークのこと
    - 企業のLANの場合、同時接続する規模が大きいため、それだけ端末のパケットをさばけるだけの性能を持つ機器で構成されている。冗長化機能やL2ループ防止機能などネットワークの運用継続性を担保する機能を持つ機器で構成されている。企業内LANの端末はアクセスポイントやL2スイッチに一旦接続し、エッジスイッチを集約するL3スイッチを経由して、インターネットや社内サーバーに接続する
- WAN
    - wide area networkの略。距離的に遠く離れた範囲のネットワークのこと。インターネットと閉域VPN網に大別でき、用途が異なる
    - インターネット
        - インターネットサービスプロバイダー(ISP)が持っているたくさんのルーターが国境を超えて無数のパケットを運んでいる。それぞれのISPにはAS番号というインターネット上で一意の管理番号が割り当てられている。ASはそれぞれの組織が管理している範囲のこと。
    - 閉域VPN網
        - 物理的に離れたLANとLANを接続するネットワーク。
        - インターネットで仮想的な専用線を作れる。
        - 企業の本社と支社を接続するような企業ネットワーク環境のイメージ
- DMZ
    - DeMilitarized Zoneの略。インターネットに公開するサーバーを設置するネットワークのこと。
    - 最近はクラウド上で構築することもあるが、データセンター上に自前構築すると必要
    - DMZの基本は、サーバーが提供するサービスを安定稼働させること。安定稼働に必要不可欠な機能が冗長化。
    - DMZはどの機器が故障してもどのケーブルが断線しても、即座に経路が切り替わり、サービスを提供し続けることができるように、同じ種別のネットワーク機器を並列に配置する。
- 新しいネットワークの形
    - SDN
        - software defined networkの略。ソフトウェアによって管理・制御される仮想的なネットワーク。あるいはそれを構成するための技術。運用管理のシンプル化を目的として、たくさんのネットワーク機器を扱うデータセンターやISPで使用されている。
        - SDNはネットワーク全体を制御するコントロールプレーンとパケットを転送するデータプレーンで構成されている。
        - SDNはオーバーレイ型とホップバイホップ型に大別できる。オーバーレイ型とホップバイホップ型どちらが多いかと言えば圧倒的にオーバーレイ型
            - オーバーレイ型はスイッチ間に仮想的なトンネルを作って、パケットを転送する方式。
            - ホップバイホップ型はスイッチ一つ一つに対して、経路の情報を配置し、その情報を元にパケットを転送する方式
    - CDN
        - 画像や動画、HTMLやCSSなどWebコンテンツで使用される、色々なファイルを大量配信するために最適化されたインターネット上のサーバーネットワーク。Webサイトの多くがこの仕組みを利用してWebコンテンツを配信している。
        - CDNはWebコンテンツを持っているオリジンサーバーと、そのキャッシュを持つエッジサーバーで構成されている。ユーザーは物理的に距離が近いエッジサーバーにアクセスする。エッジサーバーはキャッシュを持っていなかったり、有効期限が切れていたら、オリジンサーバーにアクセスする
    - IoT
        - 身の回りにあるものがインターネットにつながる仕組みのこと
        - IoTが要件に合わせたプロトコルを使用する。中でも代表的なプロトコルがCoAPとMQTT
            - MQTTはKafkaに似ている（ほぼ作りがKafka）
    - IaaS
        - サーバーやネットワークなどのインフラをインターネット上で構築するクラウドサービスの1つ
        - 物理層を意識する必要がない。

## 物理層

### 有線LAN(IEEE802.3)

- IEEE802.3のプロトコル
    - 伝送速度や使用するケーブルによって、たくさんのプロトコルが標準化されていて、それぞれIEEE802.3の後ろに1文字から2文字のアルファベットがついた正式名称が与えられている。しかし実務現場ではそのまま使用されることはなく、○○Base-△△のような、プロトコルの概要を表した別名を使用する。○○には伝送速度が入り、△△には使用する伝送媒体やレーダーの種類が入る
    - [伝送速度]Base-[伝送媒体やレーダーの種類]
    - 伝送速度
        - 100Mbps,1Gbps,など。。
    - 伝送媒体やレーダーの種類
        - T:ツイストペアケーブル
        - S:短波長レーザー
        - L:長波長レーザーなど。。
    - ツイストペアケーブルの規格
        - 
    - 光ファイバーケーブルを使用する以下のような規格もあります。
    
    | 規格名 | 伝送速度 | ケーブル |
    | --- | --- | --- |
    | 100BASE-FX | 100Mbps | マルチモード |
    | 1000BASE-SX | 1Gbps | マルチモード |
    | 1000BASE-LX | 1Gbps | マルチモード |
    | 10GBASE-SR | 10Gbps | マルチモード |
- 他にツイストペアケーブルもある。
- 銅でできたものがツイストペアケーブル、ガラスでできたものが光ファイバーケーブル
    
    ![スクリーンショット 2024-02-05 23.19.31.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/7a7e5864-a462-4ade-8192-955b500f68b1/51d67876-3b09-4bab-b14b-72edda0d78c0/%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88_2024-02-05_23.19.31.png)
    

![スクリーンショット 2024-02-05 23.20.07.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/7a7e5864-a462-4ade-8192-955b500f68b1/f77629a2-0c04-4a33-a68e-9168f3581324/%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%BC%E3%83%B3%E3%82%B7%E3%83%A7%E3%83%83%E3%83%88_2024-02-05_23.20.07.png)

- ツイストペアケーブル
    - 世の中に最も普及している
    - 見た目は1本のケーブルだが実際は8本の動線を2本ずツイストさせて束ねてケーブルにしている
    - UTPケーブル
        - LANケーブルのこと
    - STPケーブル
        - 電磁ノイズに弱いというUTPケーブルの弱点を克服しているケーブル
    - コネクタのピンアサインで分類
        - ストレートケーブルとクロスケーブルがある
            - ストレートケーブルは異なるタイプの物理ポートを接続する場合に使用
            - クロスケーブルは同じタイプの物理ポートを接続する場合使用
    - カテゴリーという概念がある。家電量販店でLANケーブルのスペック表をみると「カテゴリー6」や「カテゴリー5e」などの表記があるカテゴリーが伝送速度に直結する。カテゴリーが大きければ大きいほど、伝送速度速いプロトコルに対応できる
- 光ファイバーケーブル
    - ガラスを細い管にしたもので光信号を伝送する。光の屈折率が高い「コア」と屈折率が低い「クラッド」という同芯2層で構成されている。2層構造にして、光をコアの中に閉じ込め、損失率の低い光の伝送路を作っている。この伝送路をモードという
    - 距離を長くしても信号が衰退にしくく広帯域を保つことが可能。
    - ケーブルで分類 以下2つの種類がある
        - マルチモード光ファイバーケーブル
        - シングルモード光ファイバーケーブル
        - MPOケーブル
    - コネクタで分類すると以下3種類ある
        - SCコネクタ
        - LCコネクタ
        - MPOコネクタ
    - 二つの通信方式
        - 半二重通信
            - 送信する時と受信する時でその都度通信方向を切り替えて使用する
        - 全二重通信
            - 送信の伝送路と受信の伝送路を別々で用意し、送信と受信を同時に行う
            - 現代はこっちが基本的に使われている
        - オートネゴシエーション
            - 物理ポートで使用するプロトコルや通信方式を自動で識別する機能

### 無線LAN(IEEE802.11)

- 周波数帯域
    - 2.4GHz帯
        - 無線LANだけでなく、電子レンジやBluetooth、アマチュア無線などでも使用
        - 周波数帯域を20MHzずつ、13チャネルに分割して使用する。しかし各チャネルの波長が微妙に異なるため、周波数帯域が重ならない3つのチャネルを選んで使用している
        - 電波の特性上、障害物に強く、屋内外で使用できる。しかし、電子レンジやアマチュア無線など日常生活で電波干渉してしまうものが多いため、使用には考慮が必要。電波干渉が発生すると急につながりにくくなったり、パケットが消失したりするようになる。今までつながっていたのにみたいなことが起る
    - 5GHz帯
        - W52,W53,W56という3つの周波帯域で構成されている。
        - 各チャネルは完全に異なる波長を使用するため、19チャネルすべてを同時に使用できる。
        - 障害物に弱いだけでなく、屋外での使用に制限がある。屋外で使用できるのはW56だけ。
    - アクセスポイントの配置
        - アクセスポイントから遠ざかれば遠いほど電波が弱くなり、伝送速度が落ちる
- 変調方式
    - 一次変調でデータを電波として送れるようにして、二次変調でノイズに強くなるようにする
    - 一次変調方式がプロトコルの伝送速度に関係する
    - 無線LANプロトコルは二次変調方式と周波数帯域の組み合わせによって整理できる
- 無線LANの通信方式
    - 無線LANは送信と受信に同じチャネルを使用するため、半二重通信。つまり、送信している時、受信できない。受信している時送信できない。
    - 無線LANは衝突を回避しながら通信するCSMA/CAという仕組みがある。
    - CSMA/CAによって、同時にパケットを送信する端末は必ず1台だけになる。20台の端末が1台のアクセスポイント経由でファイルをアップロードしている場合、一見みんなが同時に通信しているように見えるが、その一瞬一瞬で実際に通信している端末は1台だけ。その1台が高速に入れ替わることによって、みんなが同時に通信しているように見える
- 高速化技術
    - シュートガードインターバル
        - マルチパス干渉を低減する機能がガードインターバル。ガードインターバルはビットを乗せた電波の最後を一定時間コピーして、先頭にくっつける機能のこと。この機能を使用すると、前後の電波が多少重なっても、元の電波を取り出すことができ、マルチパス干渉の影響を低減できる。ショートガードインターバルはコピー時間を短くする機能のこと。
    - チャネルボンディング
        - 隣り合うチャネルを同時に使用することによって、伝送速度向上を図る技術
        - チャネルボンディングを使用すると、一つのアクセスポイントが複数のチャネルを使用するようになる。したがって、2.4Ghz帯でチャネルボンディングしてしまうと、チャネルの配置ができなくなる。そのため複数のアクセスポイントを配置する無線LANでチャネルボンディングしたい場合5Ghz帯を使用する
    - MIMO
        - 無線LANにおいて、空間を流れるビットの伝送路のことを空間ストリームという。この空間ストリームを同時に複数使用することによって、伝送速度向上を図る技術をMIMO
    - ビームフォーミング
        - スマホやPCなど無線LAN端末に対して、ピンポイントで電波を飛ばす機能のことをビームフォーミングという。
- その他無線プロトコル
    - Bluetooth
        - 2.4GHz帯を79チャネルに分割し、1秒間に1600回という速度でチャネルを切り替えながら通信するFHSSという変調方式を採用している
    - Zigbee
        - 省電力型近距離無線プロトコル
        - データ受信時の消費電力が低くまた、スリープ時の待機電力がBluetoothより少ないため、スマートホームの家電や製造工場のセンサーなど必要な時にだけ通信することが多いIoTで利用されている

## データリンク層

### 有線LAN(IEEE802.3)

- イーサネットのフレームワーク
    - イーサネットによってカプセル化されるパケットのことをイーサネットフレームワークという
    - Webやメール、ファイル共有から認証に至るまで、TCP/IPでやり取りするほとんどのパケットがイーサネットII規格を使用している
    - イーサネットIIは以下5つのフィールドで構成されている.
        - プリアンシブル
        - 宛先/送信元MACアドレス
        - タイプ
        - イーサネットペイロード
        - FCS(イーサネットトレーラー)
    - プリアンシブル,宛先/送信元MACアドレス,タイプを合わせてイーサネットヘッダーという。
    - プリアンシブル
        - 「これからイーサネットフレーム送りますよ」という合図を意味する8バイト(64ビット)の特別なビットパターン
        - 受信側の端末はイーサネットフレームの最初に付与されている、この特別なビットパターンをみて「これからイーサネットフレームが届くんだな」と判断する
    - 宛先/送信元MACアドレス
        - イーサネットネットワークに接続している端末を識別する6バイト(48ビット)のID
        - イーサネットネットワークにおける住所のようなもの
        - 送信側の端末は、イーサネットフレームを送り届けたい端末のMACアドレスを「宛先MACアドレス」に、自分のMACアドレスを「送信元MACアドレス」にセットしてイーサネットフレームを送出する。
        - 受信側の端末は、宛先MACアドレスを見て、自分のMACアドレスだったら受け入れ、関係ないMACアドレスだったら破棄する。また送信元MACアドバイスをみて、どの端末から来たイーサネットフレームなのか判別する
    - タイプ
        - ネットワーク層でどんなプロトコルを使用しているかを表す2バイト(16ビット)のID
        - 使用するプロトコルによって値が決められている
    - イーサネットペイロード
        - ネットワーク層のデータそうものを表す。
        - 例えば、ネットワーク層でIPを使用しているのであれば、「イーサネットペイロード=IPパケット」
    - FCS
        - イーサネットフレームが壊れていないかを確認する4バイト(32ビット)のフィールド
        - 送信側の端末は、イーサネットフレームを送信する時「宛先MACアドレス」「送信元MACアドレス」「タイプ」「イーサネットペイロード」に対して、一定の計算を行い、その結果をFCSとしてフレームの最後に付加する
        - 受信側の端末は、受け取ったイーサネットフレームに対して、同じ計算を行い、その値がFCSと同じだったら壊れていない。正しいイーサネットフレームと判断する
        - FCSがイーサネットにおけるエラー検知を全てになっている
- MACアドレス
    - イーサネットにおいて最も重要なフィールドが宛先MACアドレスと送信元MACアドレス
    - MACアドレスはイーサネットネットワークに接続している端末の識別ID
    - 6バイト(48ビット)で構成されていて「00-0c-29-43-5e-be」や「04:0c:ce:da:3a:6c」のように1バイト(8ビット)ずつハイフンやコロンで区切って、16進数で表記する
    - 通信の種類ごとのMACアドレスの違い
        - イーサネットネットワークにおける通信は「ユニキャスト」、「ブロードキャスト」、「マルチキャスト」の3種類がある。これらは通信の宛先によって使い分けられ、宛先MAアドレスにセットするMACアドレスが微妙に異なる
        - ユニキャスト
            - 1:1の通信。Webやメールなどよくあるインターネットの通信はこれ
        - ブロードキャスト
            - 1:nの通信。nは同じイーサネットネットワークに接続している自分以外の全ての端末。ある端末がブロードキャストを送信したら、そのイーサネットネットワークにいる自分以外の全ての端末がそのフレームを受信する。このブロードキャストが届く範囲をブロードキャストドメインという。
            - ブロードキャストの送信元MACアドレスは送信元端末のMACアドレスがそのまま入る。
        - マルチキャスト
            - 1:nの通信。nは特定のグループ(マルチキャストグループ)に入っている端末。ある端末がマルチキャストを送信したら、そのグループに入っている端末だけがそのパケットを受信する。
            - 主に動画配信や証券取引所のアプリケーションで使用されている
- L2スイッチ
    - L2スイッチング
        - イーサネットヘッダーに含まれている送信元MACアドレスと自分自身のポート番号をMACアドレステーブルというメモリ上の表で管理することによって、イーサネットフレームの転送先を切り替え、通信の効率化を図っている。このイーサネットフレームの転送先を切り替える機能をL2スイッチングという
    - VLAN
        - 1台のL2スイッチを仮想的に複数のL2スイッチに分割する技術
        - VLANを実現する機能は「ポートベースVLAN」「タグVLAN」の2種類に分けることができる
        - ポートベースVLAN
            - ひとつのポートに対して、一つのVLANを割り当てる機能
        - タグVLAN
            - イーサネットフレームにVLAN情報をVLANタグとしてくっつける機能
            - 一つのポート、一つのケーブルに複数のVLANのイーサネットフレームを流せるようにする
    - PoE
        - ツイストペアケーブルを使用して電源を供給する機能
        - 天井裏や壁裏など電源ケーブルが届きづらい場所に設置するアクセスポイントやネットワークカメラに対して、ツイストペアケーブル1本で電源とデータを両方供給できるようになり、コンセントを敷設する必要がなくなる

### 無線LAN(IEEE802.11)

- IEEE802.11フレームのフレームフォーマット
    - プリアンシブル
        - IEEE802.11フレームをおくりますよという合図
    - フレーム制御
        - データフレーム
            - IPパケットを送受信するためのフレーム
        - 管理フレーム
            - どのアクセスポイントとどのように接続するかを管理するフレーム
        - 制御フレーム
            - データフレームの転送を助けるためのフレーム
            - 無線LANは有線LANと比べて不安定なため、その確認応答を行う
    - Duration
    - MACアドレス1/2/3/4
        - データフレームのMACアドレス
            - インフラモード
                - アクセスポイントを介して通信するネットワーク構成
            - アドホックモード
                - アクセスポイントを介さず、無線LAN端末どうしが直接通信するネットワーク構成
            - WDSモード
                - アクセスポイントどうしで通信するネットワーク構成
        - 管理フレームのMACアドレス
            - 無線LAN端末とアクセスポイントだけでやりとりされるフレーム
        - 制御フレームのMACアドレス
            - 管理フレームと同じで、無線LAN端末とアクセスポイントだけでやりとりされるフレーム
    - シーケンス制御
    - IEEE802.11ペイロード
        - 管理フレームの場合無線LNAの名前を表すSSIDや使用するチャネル、サポートしている伝送速度などネットワークに関するいろいろな情報がセットされる
    - FCS
- 無線LAN端末が繋がるまで
    - 無線LANは有線LANと同等の機能を保ちつつ、よりセキュリティに気を配りながら接続する
    - アソシエーション→認証→共有鍵生成→暗号化通信の4つのフェーズを経て暗号化通信を行う
- アソシエーションフェーズ
    - どのアクセスポイントと接続するか決めるフェーズ
    - スキャンして、認証してアソシエーションする
    - スキャン
        - 周辺にある無線LANの情報を収集する。接続したいSSIDを見つけたら自分の存在をアクセスポイントに伝える
    - 認証
        - オープンシステム認証と共有鍵認証に2種類
        - オープンシステム認証
            - 認証処理行わない
        - 共有鍵認証
            - 共有されたパスワードをもとに認証
        - ここでの認証はとりあえずオープンシステム認証でパスさせておいて、実際の認証はアソシエーションフェーズの後の認証フェーズで行う
    - アソシエーション
        - 最終確認
- 認証フェーズ
    - パーソナルモードとエンタープライズモードがある
    - パーソナルモード
        - パスワードで認証する方式
        - パスワードからマスターキーと呼ばれる共有鍵の素を生成する
        - パーソナルモードはシンプルで分かりやすい半面パスワードが流出してしまうと誰でも接続できてしまうため定期的にパスワードを変更するべき
    - エンタープライズモード
        - デジタル証明書やIDパスワード、SIMカードなどを使用する認証方法
        - 認証サーバーで一元的に認証できるから企業でよく使われている
        - 無線LAN端末と認証サーバーはお互いが持っている情報を交換しあい互いが互いを証明しあう、認証が成功すると、認証サーバーからアクセスポイントと無線LAN端末にセッション鍵が配布され、それを元にマスターキーを生成する
        - ほかにもEAPというデジタル証明書やSIM等で双方向に認証を行うプロトコルもある
- 共有鍵生成フェーズ
    - 認証フェーズで生成したマスターキーから実際の暗号化/復号で使用する共有鍵を生成するフェーズ
- 暗号化通信フェーズ
    - 暗号化方式は以下で下に行くほどセキュリティレベルが上がる
        - WEP
            - 現在は使っていない
        - WPA
            - WEPを改良したが脆弱性があるためつかっていない
        - WPA2
            - WPAをさらに改良したもの
            - 暗号化アルゴリズムとしてAESを採用。とても安全で今のところ解読方法が見つかっていない
        - WPA3
            - WPA2をさらに改良したもの
            - AESよりさらに安全なCSNA対応
- 無線LANの形
    - 分散集中型
    - 集中管理型
    - クラウド管理型
- 無線LANに関する色々な機能
    - ゲストネットワーク
    - MACアドレスフィルタリング
    - Web認証
    - バンドステアリング

### ARP

- ネットワークの世界において、アドレスは「MACアドレス」と「IPアドレス」がある
- 「MACアドレス」はNICそのものに焼き付けられている物理的アドレス。
    - データリンク層で動作
- 「IPアドレス」はOS上で設定する論理的なアドレス
    - ネットワーク層で動作
- このふたつのアドレスを紐付け、データリンク層とネットワーク層の架け橋的な役割を担っているプロトコルが「ARP」
- 送信元MACアドレスは自分自身のNICに書き込まれているのでわかるが、宛先MACアドレスについては知らない。そこで実際のデータ通信に先立って、ARPで宛先IPv4アドレスから宛先MACアドレスを求める。これをアドレス解決という
- ARPのフレームフォーマット
    - ARPはL2ペイロードにデータリンク層とネットワーク層の情報を詰め込むことによって、MACアドレスととIPアドレスの紐付けを行っている
    - 以下は各フィールド
        - ハードウェアタイプ
        - プロトコルタイプ
        - ハードウェアアドレスサイズ
        - プロトコルアドレスサイズ
        - オペレーションコード
        - 送信元MACアドレス/送信元IPv4アドレス
        - 目標MACアドレス/目標IPv4アドレス
- ARPにおけるアドレス解決の流れ
    - 宛先PCに○○はいますか？と投げて、私ですと返すように流れ。
- ARPのキャッシュ機能
    - 全ての通信の始まりの始まりはARP。ARPでパケットを送信するべきMACアドレスを知って、初めて通信できるようになる
    - 弱点として、ブロードキャストを前提としているため全ての端末に対してデータを送る非効率な通信。MACアドレスもIPv4もそんなに頻繁に変わるわけではないため、ARPはアドレス解決した内容を一定時間保持するキャッシュ機能がある
- GARPを利用した機能
    - ARP以外にも効率的なアドレス解決を実現するための特別なARP。
    - ARPフィールドの目標IPv4アドレスに自分自身のIPv4アドレスをセットした特別なARP
    - IPv4アドレスの重複検知ができる
    - 隣接機器のテーブル更新ができる

### その他のL2プロトコル

- PPP
    - ポイントとポイントを1:1で結ぶためのレイヤー2プロトコル
- PAP
    - PPPクラウアントがユーザーIDとパスワードを送信し、サーバーがあらかじめ設定してあるユーザーIDをパスワードを元に認証する。
- CHAP
    - PAPのセキュリティ的な弱点をカバーしてパワーアップさせているプロトコル
- PPPoE
    - もともとダイヤルアップ接続で使用されていたPPPをイーサネットネットワーク上でも使用できるように拡張したプロトコル
    - フレッツ光ネクトとでフレッツ網と呼ばれる閉域網に接続する時使用する。
- IPoE
    - PPPoEのようにPPPでカプセル化することなく、イーサネットとIPをそのまま使用できることからネイティブ接続方式と呼ばれる
- PPTP
    - IPsecと同じようにインターネット上に仮想的な専用線(トンネル)を作るVPNプロトコル
    - 暗号化機能がないや脆弱性があるなどで使用されていない傾向
- L2TP
    - IPsecやPPTPと同じくインターネットに仮想的な専用を作るプロトコル
- L2TP over Ipsec
    - L2TPは暗号化機能を持っていないため、それ単体で使用しない。セキュリティ機能を持つIPsecを併用してL2TP over Ipsecとして使うのがほとんど

## ネットワーク層

### IPv4

- IPv4のパケットフォーマット
    - IPによってカプセル化されるパケットをIPパケットという。
        - IPパケットはIPヘッダーとIPペイロードで構成されている
        - パケット交換通信鍵を持っているのがIPヘッダー
    - IPヘッダーの各フィールド
        - バージョン
            - IPv4は4
        - ヘッダー長
            - IPv4のヘッダーの長さ
        - ToS
            - IPv4パケットの優先度を表す1バイトのフィールド
            - 優先制御や帯域制御、輻輳制御などのQoSで使用する
                - あらかじめこの値だったら最優先で転送するなどふるまいを設定しておく
        - パケット長
            - IPv4ヘッダーとIPv4ペイロードをあわせたパケット全体の長さを表す
            - パケットを受け取る端末はこのフィールドを見ることによってどこまでがIPv4パケットなのか知ることができる
        - 識別子
            - パケット交換方式の通信では、データをそのままの状態で送信するわけではなく、送りやすいように小分けに送信する。IPでデータを小分けにする処理をIPフラグメンテーションという。
            - 「識別子」「フラグ」「フラグオフセット」にはIPフラグメンテーションに関する情報が格納されている
            - 識別子はパケットを作成するときにランダムに割り当てるパケットのID
        - フラグ
            - フラグは3ビットで構成されていて、1ビット目は使用しない。
            - 2ビット目は「DFビット」といい、IPパケットをフラグメンテーションして良いかどうか表す。0だったらフラグメンテーションを許可し、1なら許可しない。
                - フラグメンテーションが発生すると、その分処理遅延が発生し、パフォーマンスは劣化する。なので最近のアプリは1にして許可しないようにして、上位層でデータサイズの調整をしている
            - 3ビット目はMFビットといい、フラグメンテーションされたIPv4パケットが後ろに続くかどうか表す。0だったらフラグメンテーションされたIPv4パケットが後ろに続かない。1だったらフラグメンテーションされたIPv4パケットが後ろにつく
        - フラグメントオフセット
            - フラグメンオフセットはフラグメンテーションしたとき、そのパケットがオリジナルパケットの先頭からどこに位置するかを示すフィールド
            - パケットを受け取る端末はこの値を見て、IPパケットの順序を正しく並べている
        - TTL
            - TTLはパケットの寿命を表すフィールド。IPの世界では、IPパケットの寿命は「軽油するルーターの数」で表す。軽油するルーターの数をポップ数という
            - TTLの値はルーターを軽油するたびに、つまりネットワークを軽油するたびにひとつずつ減算され、値が「0」になるとパケットが破棄される
        - プロトコル番号
            - Pv4ペイロードがどんなプロトコルで構成されているか表す
        - ヘッダーチェックサム
            - Pv4ヘッダーの整合性をチェックするために使用されるフィールド
        - 送信元/宛先Pv4アドレス
            - Pv4ネットワークに接続されている端末を泡ラス４バイトの識別ID
            - Pv4ネットワークにおける住所のようなもの
            - IPネットワークで通信する端末は全てIPアドレスを持つ必要がある。
            - 必ずしも1端末あたり一つのIPアドレスしか持てないわけではなく、機器の種類や用途に応じて、複数のIPアドレスをもつことも可能
                - 例えば、ルーターはIPネットワークに繋ぐために、ポートごとにIPアドレスを持ち、合わせて管理するためだけに用意されるイーサネット管理ポートにもIPアドレスを持つ
        - オプション
            - IPv4パケット送信における拡張機能が格納される可変長のフィールド
        - パディング
            - IPv4ヘッダーのビット数を整えるために使用されるフィールド
- IPv4アドレスとサブネットマスク
    - IPv4は32ビット(4バイト)で構成されていて、「192.168.1.1」や「172.16.1.1」のように8ビット(1バイト)ずつドットで区切って、10進数で表記する。ドットで区切られたグループのことをオクテットという。先頭から第1オクテット,第2オクテット…
    - サブネットマスクはネットワークとホストの分かれ目
        - IPv4じゃそれ単体で使用するわけでなく、サブネットマスクという32ビットの値とセットで使用する
        - IPv4アドレスはネットワーク部とホスト部の二つで構成されている。
            - ネットワーク部は「どのIPv4ネットワークにいるのか」を表す
            - ホスト部は「どの端末なのか」を表す。
        - サブネットマスクはこの二つを区切る目印ののようなもの1がネットワーク部、0がホスト部で表す
        - IPv4アドレスとサブネットマスクを組み合わせて見ることによって、「どのIPv4ネットワークにいるどこの端末なのか」を識別することができる
    - 10進数表記とCIDR表記
        - サブネットマスクには10進数表記とCIDR表記の2種類の表記方法がある
            - 例えば「192.168.100.1」というIPv4アドレスに「255.255.255.0」というサブネットマスクが設定されている場合、CIDR表記では「192.168.100.1/24」となる。
                - どちらにせよ、ネットワーク部が「192.168.100.1」でホスト部が「1」であることがわかる
- いろいろなIPv4アドレス
    - IPv4アドレスは「0.0.0.0」から「255.255.255.255」まで43億個あるがどれも好き勝手使って良いわけではない。どのように使うか決まっている
    - クラスフルアドレッシング
        - アドレスクラスにもとづいてIPv4アドレスを割り当てる方式
    - クラスレスアドレッシング
        - アドレスクラスにとらわれずにIPv4アドレスを割り当てる方式
        - ネットワーク部とホスト部の他にサブネット部という新しい概念を導入して、新しいネットワーク部を作り出す
    - 使用場所による分類
        - IPv4アドレスは使用場所によって「グローバルIPv4アドレス」と「プライベートIPv4アドレス」の2種類に分類できる
            - 前者はインターネットにおける一位なIPv4アドレス。後者は企業や家庭のネットワークなど限られた組織内だけで一意なIPv4アドレス
        - グローバルIPv4アドレス
        - プライベートIPv4アドレス
            - IPアドレスを変換することをNATという
    - 除外アドレス
        - 端末には設定できないアドレス、中でも実務で重要なIPアドレスが「ネットワークアドレス」、「ブロードキャストアドレス」、「ループバックアドレス」の3つ
        - ネットワークアドレス
            - ホスト部のビット数が全て0のIPv4アドレスでネットワークそのものを表す。
            - 例えば「192.168.100.1」というIPアドレスに「255.255.255.0」というサブネットマスクが設定されていたら、「192.168.100.0」がネットワークアドレス
        - ブロードキャストアドレス
            - ホスト部のビット数が全て「1」のIPv4アドレスで同じネットワークに存在する全ての端末で表す
            - 例えば「192.168.100.1」というIPアドレスに「255.255.255.0」というサブネットマスクが設定されていたら、「192.168.100.255」がブロードキャストアドレス
        - ループバックアドレス
            - 自分自身を表すIPv4アドレス。

### IPv6

- IPv4は43億子までしかIPアドレスを割り当てられないため、使い切る未来を避けるために新たに標準化されたのがIPv6
- IPv4との違いはヘッダーの長さとフィールド数の削減
    - IPv6はヘッダーの長さが長く、40バイト固定
    - IPv6は性能向上の足しかせになっていたりしたフィールドを削り、徹底的なシンプル化が図られている
        - フィールド数が減ることでたくさんのフィールドを精査する必要がなくなり、ネットワーク機器の処理負荷が軽減し、パフォーマンスが向上
    - バージョン
        - バージョンは6
    - トラフィッククラス
    - フローラベル
        - 通信フローを識別するもの
        - IPv4にはこのフィールドはない。別の方法でやっていた
    - ペイロード長
        - IPv4ではパケット長としてヘッダーとペイロードの長さを合わせた値で表現されていた
    - ネクストヘッダー
        - IPv6ヘッダーの直後に続くヘッダーを表す。拡張ヘッダーがある場合、拡張ヘッダーを示す値が入る
    - ホップリミット
        - ポップ数の上限を表す。IPv4のTTLに相当する
    - 送信元/宛先IPv6アドレス
        - IPv4アドレスとは大きく変わらない
- IPv6アドレスとプレフィックス
    - サブネットプレフィックスとインターフェイスID
        - IPv6アドレスはネットワークを識別する「サブネットプレフィックス」と、端末を識別する「インターフェースID」の二つで構成されている
        - サブネットプレフィックスはIPv4でいうネットワーク部。
        - インターフェイスIDはIPv4でいうホスト部。
    - IPv6アドレスの表記ルール
        - 各フィールドの先頭にある連続する「0」は省略できる
        - 複数のフィールドをまたいで「0」が続く場合は、「::」に省略できる
            - 省略できるのは一回だけ
            - オール「0」のフィールドがひとつの場合は省略できない
            - 可能な限り短くする
            - 最も省略できるところで省略する
            - 省略できるところが同じ長さだった場合は最初の箇所で省略する
            - 小文字で表記する
    - IPv6アドレスは複雑すぎてなかなか普及が進まない。
- いろいろなIPv6アドレス
    - ユニキャストアドレス
        - 1:1のユニキャスト通信で使用するIPv6アドレス。webやメールの通信はクライアントとサーバーの間だけでパケットがやり取りされるユニキャスト
        - グローバルユニキャストアドレス
            - IPv4のグローバルIPv4アドレス相当
        - ユニークローカルアドレス
            - IPv4アドレスのプライベートIPv4アドレス相当
        - リンクローカルアドレス
            - 同じIPv6ネットワークにおいてのみ通信できるアドレス。全てのIPv6インターフェースにはリンクローカルアドレスを割り当てる必要があり、デフォルトで自動的に割り当てられる。
    - マルチキャストアドレス
        - IPv4アドレスのクラスDに相当する。特定のグループ(マルチキャストグループ)に対する通信で使用する。
        - IPv4のマルチキャストは動画配信サービスや証券取引アプリなど限られた用途に使用していたが、IPv6ではIPv6におけるARPであるNDPでもマルチキャストが使用されていて、かなり重要な役割を担っている。IPv4にあったブロードキャストも、IPv6ではマルチキャストの一部として吸収された
    - エニーキャストアドレス
        - 複数の端末によって共有されているグローバルユニキャストアドレス。
        - グローバルユニキャストアドレスは一つ一つの端末に割り当て、1:1の通信に使用
        - 一つのグローバルユニキャストアドレスを複数の端末に割り当てるとエニーキャストアドレスになる
            - エニーキャストアドレスに対してパケット送信すると、そのパケットはルーターによって、経路的に最も近いサーバーに転送される。エニーキャストは単純にユニキャストで通信するより、より近いサーバーで応答を返すことができるため応答速度の向上を図れる。また広域で負荷分散が図れたりDDos攻撃の局所化を図れたり様々なメリットがある
